{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;const API=\"\".concat(BACKEND_URL,\"/api\");export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('token'));const[loading,setLoading]=useState(true);useEffect(()=>{if(token){axios.defaults.headers.common['Authorization']=\"Bearer \".concat(token);fetchUser();}else{setLoading(false);}},[token]);const fetchUser=async()=>{try{const response=await axios.get(\"\".concat(API,\"/auth/me\"));setUser(response.data);}catch(error){console.error('Erro ao buscar usuário:',error);logout();}finally{setLoading(false);}};const login=async(email,password)=>{const response=await axios.post(\"\".concat(API,\"/auth/login\"),{email,password});const{token:newToken,user:userData}=response.data;localStorage.setItem('token',newToken);axios.defaults.headers.common['Authorization']=\"Bearer \".concat(newToken);setToken(newToken);setUser(userData);return userData;};const register=async(name,email,password)=>{const response=await axios.post(\"\".concat(API,\"/auth/register\"),{name,email,password});const{token:newToken,user:userData}=response.data;localStorage.setItem('token',newToken);axios.defaults.headers.common['Authorization']=\"Bearer \".concat(newToken);setToken(newToken);setUser(userData);return userData;};const logout=()=>{localStorage.removeItem('token');delete axios.defaults.headers.common['Authorization'];setToken(null);setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,token,loading,login,register,logout},children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export default AuthContext;","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","jsx","_jsx","AuthContext","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","API","concat","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","loading","setLoading","defaults","headers","common","fetchUser","response","get","data","error","console","logout","login","email","password","post","newToken","userData","setItem","register","name","removeItem","Provider","value","useAuth","context","Error"],"sources":["/app/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst AuthContext = createContext(null);\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\nconst API = `${BACKEND_URL}/api`;\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (token) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      fetchUser();\n    } else {\n      setLoading(false);\n    }\n  }, [token]);\n\n  const fetchUser = async () => {\n    try {\n      const response = await axios.get(`${API}/auth/me`);\n      setUser(response.data);\n    } catch (error) {\n      console.error('Erro ao buscar usuário:', error);\n      logout();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (email, password) => {\n    const response = await axios.post(`${API}/auth/login`, { email, password });\n    const { token: newToken, user: userData } = response.data;\n    \n    localStorage.setItem('token', newToken);\n    axios.defaults.headers.common['Authorization'] = `Bearer ${newToken}`;\n    setToken(newToken);\n    setUser(userData);\n    \n    return userData;\n  };\n\n  const register = async (name, email, password) => {\n    const response = await axios.post(`${API}/auth/register`, { name, email, password });\n    const { token: newToken, user: userData } = response.data;\n    \n    localStorage.setItem('token', newToken);\n    axios.defaults.headers.common['Authorization'] = `Bearer ${newToken}`;\n    setToken(newToken);\n    setUser(userData);\n    \n    return userData;\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    delete axios.defaults.headers.common['Authorization'];\n    setToken(null);\n    setUser(null);\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, loading, login, register, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport default AuthContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}